<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á—ë—Ç –¥–æ—Ö–æ–¥–æ–≤ TheGame</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-backdrop { animation: fadeIn 0.2s ease-out; }
        .modal-content { animation: slideUp 0.3s ease-out; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const tg = window.Telegram?.WebApp || { expand: () => {}, CloudStorage: null };
        tg.expand();

        // –ò–∫–æ–Ω–∫–∏
        const Plus = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>);
        const Trash = () => (<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>);
        const Edit = () => (<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>);
        const X = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>);
        const Download = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>);

        function FinanceTracker() {
            const [activeTab, setActiveTab] = useState('summary');
            const [showModal, setShowModal] = useState(false);
            const [editingIndex, setEditingIndex] = useState(null);
            const [modalType, setModalType] = useState('');
            const [loading, setLoading] = useState(true);
            const [formData, setFormData] = useState({});

            // –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
            const [longevity, setLongevity] = useState([]);
            const [individual, setIndividual] = useState([]);
            const [rental, setRental] = useState([]);
            const [expenses, setExpenses] = useState([]);
            const [passive, setPassive] = useState([]);
            const [students, setStudents] = useState([]);
            const [monthlyResults, setMonthlyResults] = useState([]);

            const tabs = [
                { id: 'summary', name: '–ú–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç', emoji: 'üìÖ' },
                { id: 'longevity', name: '–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ', emoji: 'üèÉ' },
                { id: 'individual', name: '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª–∫–∏', emoji: 'üë§' },
                { id: 'rental', name: '–ê—Ä–µ–Ω–¥–∞', emoji: 'üè†' },
                { id: 'expenses', name: '–†–∞—Å—Ö–æ–¥—ã', emoji: 'üí∏' },
                { id: 'passive', name: '–ü–∞—Å—Å–∏–≤–Ω—ã–π', emoji: 'üí∞' },
                { id: 'students', name: '–ë–∞–∑–∞', emoji: 'üë•' },
                { id: 'analytics', name: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞', emoji: 'üìä' },
                { id: 'monthly', name: '–ü–æ –º–µ—Å—è—Ü–∞–º', emoji: 'üìÜ' },
                { id: 'report', name: '–°–≤–æ–¥–∫–∞', emoji: 'üìà' }
            ];

            // –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
            const loadFromCloud = async (key, defaultData) => {
                try {
                    if (tg.CloudStorage) {
                        return new Promise((resolve) => {
                            tg.CloudStorage.getItem(key, (error, value) => {
                                if (!error && value) {
                                    try { resolve(JSON.parse(value)); }
                                    catch { resolve(defaultData); }
                                } else { resolve(defaultData); }
                            });
                        });
                    }
                    const saved = localStorage.getItem(key);
                    return saved ? JSON.parse(saved) : defaultData;
                } catch { return defaultData; }
            };

            const saveToCloud = async (key, data) => {
                try {
                    const value = JSON.stringify(data);
                    if (tg.CloudStorage) tg.CloudStorage.setItem(key, value);
                    localStorage.setItem(key, value);
                } catch (error) { console.error('Save error:', error); }
            };

            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            useEffect(() => {
                const loadAllData = async () => {
                    const [l, i, r, e, p, s, m] = await Promise.all([
                        loadFromCloud('longevity', []),
                        loadFromCloud('individual', []),
                        loadFromCloud('rental', []),
                        loadFromCloud('expenses', []),
                        loadFromCloud('passive', []),
                        loadFromCloud('students', []),
                        loadFromCloud('monthlyResults', [])
                    ]);
                    setLongevity(l);
                    setIndividual(i);
                    setRental(r);
                    setExpenses(e);
                    setPassive(p);
                    setStudents(s);
                    setMonthlyResults(m);
                    setLoading(false);
                };
                loadAllData();
            }, []);

            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            useEffect(() => { if (!loading) saveToCloud('longevity', longevity); }, [longevity, loading]);
            useEffect(() => { if (!loading) saveToCloud('individual', individual); }, [individual, loading]);
            useEffect(() => { if (!loading) saveToCloud('rental', rental); }, [rental, loading]);
            useEffect(() => { if (!loading) saveToCloud('expenses', expenses); }, [expenses, loading]);
            useEffect(() => { if (!loading) saveToCloud('passive', passive); }, [passive, loading]);
            useEffect(() => { if (!loading) saveToCloud('students', students); }, [students, loading]);
            useEffect(() => { if (!loading) saveToCloud('monthlyResults', monthlyResults); }, [monthlyResults, loading]);

            // –†–∞—Å—á—ë—Ç—ã
            const totals = useMemo(() => {
                const longevityTotal = longevity.reduce((sum, item) => sum + (item.profit || 0), 0);
                const individualTotal = individual.reduce((sum, item) => sum + (item.amount || 0), 0);
                const rentalTotal = rental.reduce((sum, item) => sum + (item.amount || 0), 0);
                const passiveTotal = passive.reduce((sum, item) => sum + (item.amount || 0), 0);
                const expensesTotal = expenses.reduce((sum, item) => sum + (item.amount || 0), 0);
                
                const totalIncome = longevityTotal + individualTotal + rentalTotal + passiveTotal;
                const netProfit = totalIncome - expensesTotal;
                const progress = Math.round((netProfit / 1000000) * 100);

                return { longevityTotal, individualTotal, rentalTotal, passiveTotal, expensesTotal, totalIncome, netProfit, progress };
            }, [longevity, individual, rental, passive, expenses]);

            const formatNumber = (num) => new Intl.NumberFormat('ru-RU').format(Math.round(num));

            const openModal = (type, index = null) => {
                setModalType(type);
                setEditingIndex(index);
                
                if (index !== null) {
                    const dataMap = { longevity, individual, rental, expenses, passive, students, monthly: monthlyResults };
                    setFormData({...dataMap[type][index]});
                } else {
                    const defaults = {
                        longevity: { location: '', rateType: '50%', hallExpense: 0 },
                        expenses: { type: '–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞' },
                        individual: { type: '–õ–∞—Ç–∏–Ω—Å–∫–∏–π –∫–≤–∞—Ä—Ç–µ—Ç' },
                        students: { status: '–ê–∫—Ç–∏–≤–Ω—ã–π' }
                    };
                    setFormData(defaults[type] || {});
                }
                setShowModal(true);
            };

            const calculateLongevityExpense = (income, rateType) => {
                if (rateType === '50%') return income * 0.5;
                if (rateType === '700‚ÇΩ') return 700;
                if (rateType === '1000‚ÇΩ') return 1000;
                if (rateType === '100%') return income;
                return 0;
            };

            const getHallExpenseByLocation = (location) => {
                const defaults = { '–ë—É–¥–µ–Ω–Ω–æ–≥–æ': 0, '–ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è': 0, '–ü–∞—Ä–∫': 0 };
                return defaults[location] || 0;
            };

            const saveData = () => {
                if (modalType === 'longevity') {
                    const people = parseInt(formData.people) || 0;
                    const income = people * 280;
                    const teacherExpense = calculateLongevityExpense(income, formData.rateType || '50%');
                    const hallExpense = parseFloat(formData.hallExpense) || 0;
                    const profit = income - teacherExpense - hallExpense;

                    const newData = {
                        date: formData.date || '',
                        location: formData.location || '',
                        teacher: formData.teacher || '',
                        rateType: formData.rateType || '50%',
                        people,
                        income,
                        teacherExpense,
                        hallExpense,
                        profit,
                        comment: formData.comment || ''
                    };

                    if (editingIndex !== null) {
                        const updated = [...longevity];
                        updated[editingIndex] = newData;
                        setLongevity(updated);
                    } else {
                        setLongevity([...longevity, newData]);
                    }
                } else if (modalType === 'individual') {
                    const newData = {
                        date: formData.date || '',
                        type: formData.type || '',
                        client: formData.client || '',
                        amount: parseFloat(formData.amount) || 0,
                        comment: formData.comment || ''
                    };
                    if (editingIndex !== null) {
                        const updated = [...individual];
                        updated[editingIndex] = newData;
                        setIndividual(updated);
                    } else {
                        setIndividual([...individual, newData]);
                    }
                } else if (modalType === 'rental') {
                    const newData = {
                        date: formData.date || '',
                        name: formData.name || '',
                        amount: parseFloat(formData.amount) || 0,
                        comment: formData.comment || ''
                    };
                    if (editingIndex !== null) {
                        const updated = [...rental];
                        updated[editingIndex] = newData;
                        setRental(updated);
                    } else {
                        setRental([...rental, newData]);
                    }
                } else if (modalType === 'expenses') {
                    const newData = {
                        date: formData.date || '',
                        type: formData.type || '',
                        what: formData.what || '',
                        amount: parseFloat(formData.amount) || 0,
                        comment: formData.comment || ''
                    };
                    if (editingIndex !== null) {
                        const updated = [...expenses];
                        updated[editingIndex] = newData;
                        setExpenses(updated);
                    } else {
                        setExpenses([...expenses, newData]);
                    }
                } else if (modalType === 'passive') {
                    const newData = {
                        date: formData.date || '',
                        what: formData.what || '',
                        amount: parseFloat(formData.amount) || 0,
                        comment: formData.comment || ''
                    };
                    if (editingIndex !== null) {
                        const updated = [...passive];
                        updated[editingIndex] = newData;
                        setPassive(updated);
                    } else {
                        setPassive([...passive, newData]);
                    }
                } else if (modalType === 'students') {
                    const newData = {
                        name: formData.name || '',
                        phone: formData.phone || '',
                        group: formData.group || '',
                        subscription: formData.subscription || '',
                        expiryDate: formData.expiryDate || '',
                        status: formData.status || '–ê–∫—Ç–∏–≤–Ω—ã–π',
                        note: formData.note || ''
                    };
                    if (editingIndex !== null) {
                        const updated = [...students];
                        updated[editingIndex] = newData;
                        setStudents(updated);
                    } else {
                        setStudents([...students, newData]);
                    }
                } else if (modalType === 'monthly') {
                    const longevityIncome = parseFloat(formData.longevityIncome) || 0;
                    const individualIncome = parseFloat(formData.individualIncome) || 0;
                    const rentalIncome = parseFloat(formData.rentalIncome) || 0;
                    const passiveIncome = parseFloat(formData.passiveIncome) || 0;
                    const expensesAmount = parseFloat(formData.expenses) || 0;
                    
                    const newData = {
                        month: formData.month || '',
                        year: formData.year || '',
                        longevityIncome,
                        individualIncome,
                        rentalIncome,
                        passiveIncome,
                        expenses: expensesAmount,
                        profit: longevityIncome + individualIncome + rentalIncome + passiveIncome - expensesAmount,
                        note: formData.note || ''
                    };
                    if (editingIndex !== null) {
                        const updated = [...monthlyResults];
                        updated[editingIndex] = newData;
                        setMonthlyResults(updated);
                    } else {
                        setMonthlyResults([...monthlyResults, newData]);
                    }
                }

                setShowModal(false);
                setFormData({});
            };

            const deleteItem = (type, index) => {
                if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å?')) return;
                
                const setters = { longevity: setLongevity, individual: setIndividual, rental: setRental, expenses: setExpenses, passive: setPassive, students: setStudents, monthly: setMonthlyResults };
                const data = { longevity, individual, rental, expenses, passive, students, monthly: monthlyResults };
                
                setters[type](data[type].filter((_, i) => i !== index));
            };

            const exportToCSV = () => {
                let csv = '–°–≤–æ–¥–∫–∞ –∑–∞ –º–µ—Å—è—Ü - TheGame\n\n';
                csv += '–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–°—É–º–º–∞\n';
                csv += `–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ,${totals.longevityTotal}‚ÇΩ\n`;
                csv += `–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏,${totals.individualTotal}‚ÇΩ\n`;
                csv += `–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞,${totals.rentalTotal}‚ÇΩ\n`;
                csv += `–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥,${totals.passiveTotal}‚ÇΩ\n`;
                csv += `–†–∞—Å—Ö–æ–¥—ã,-${totals.expensesTotal}‚ÇΩ\n`;
                csv += `–ß–ò–°–¢–ê–Ø –ü–†–ò–ë–´–õ–¨,${totals.netProfit}‚ÇΩ\n`;
                
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'thegame_summary.csv';
                link.click();
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center">
                        <div className="text-white text-xl">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-white p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* –®–∞–ø–∫–∞ */}
                        <div className="mb-6">
                            <h1 className="text-3xl font-bold mb-2">üí∞ TheGame</h1>
                            <p className="text-slate-400 mb-4">–ü—É—Ç—å –∫ 1–ú</p>
                            
                            <div className="bg-slate-800 rounded-lg p-4 border border-slate-700">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-slate-300">–ü—Ä–æ–≥—Ä–µ—Å—Å –∫ —Ü–µ–ª–∏</span>
                                    <span className="text-2xl font-bold text-blue-400">{totals.progress}%</span>
                                </div>
                                <div className="w-full bg-slate-700 rounded-full h-4">
                                    <div 
                                        className="bg-gradient-to-r from-blue-600 to-green-500 h-4 rounded-full transition-all duration-500"
                                        style={{width: `${Math.min(totals.progress, 100)}%`}}
                                    ></div>
                                </div>
                                <div className="flex justify-between text-xs text-slate-400 mt-1">
                                    <span>385,000‚ÇΩ</span>
                                    <span>1,000,000‚ÇΩ</span>
                                </div>
                            </div>
                        </div>

                        {/* –í–∫–ª–∞–¥–∫–∏ */}
                        <div className="flex gap-2 mb-6 overflow-x-auto pb-2 hide-scrollbar">
                            {tabs.map((tab) => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex items-center gap-2 px-4 py-2 rounded-lg transition whitespace-nowrap ${
                                        activeTab === tab.id ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'
                                    }`}
                                >
                                    <span>{tab.emoji}</span>
                                    {tab.name}
                                </button>
                            ))}
                        </div>

                        {/* –ö–æ–Ω—Ç–µ–Ω—Ç */}
                        <div className="bg-slate-800 rounded-lg border border-slate-700 p-4">
                            {/* –ú–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç */}
                            {activeTab === 'summary' && (
                                <div>
                                    <h2 className="text-xl font-bold mb-4">üìÖ –ú–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç</h2>
                                    <div className="overflow-x-auto">
                                        <table className="w-full">
                                            <thead>
                                                <tr className="border-b border-slate-700">
                                                    <th className="text-left py-2 px-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                                    <th className="text-right py-2 px-2">–î–æ—Ö–æ–¥</th>
                                                    <th className="text-right py-2 px-2">–†–∞—Å—Ö–æ–¥</th>
                                                    <th className="text-right py-2 px-2">–ü—Ä–∏–±—ã–ª—å</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr className="border-b border-slate-700/50">
                                                    <td className="py-2 px-2">–ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –¥–æ–ª–≥–æ–ª–µ—Ç–∏–µ</td>
                                                    <td className="text-right py-2 px-2 text-green-400">{formatNumber(longevity.reduce((s,i)=>s+i.income,0))}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-red-400">{formatNumber(longevity.reduce((s,i)=>s+i.teacherExpense+i.hallExpense,0))}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-blue-400">{formatNumber(totals.longevityTotal)}‚ÇΩ</td>
                                                </tr>
                                                <tr className="border-b border-slate-700/50">
                                                    <td className="py-2 px-2">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏</td>
                                                    <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.individualTotal)}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2">0‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-blue-400">{formatNumber(totals.individualTotal)}‚ÇΩ</td>
                                                </tr>
                                                <tr className="border-b border-slate-700/50">
                                                    <td className="py-2 px-2">–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞</td>
                                                    <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.rentalTotal)}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2">0‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-blue-400">{formatNumber(totals.rentalTotal)}‚ÇΩ</td>
                                                </tr>
                                                <tr className="border-b border-slate-700/50">
                                                    <td className="py-2 px-2">–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥</td>
                                                    <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.passiveTotal)}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2">0‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-blue-400">{formatNumber(totals.passiveTotal)}‚ÇΩ</td>
                                                </tr>
                                                <tr className="border-b border-slate-700/50">
                                                    <td className="py-2 px-2">–†–∞—Å—Ö–æ–¥—ã</td>
                                                    <td className="text-right py-2 px-2">0‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-red-400">{formatNumber(totals.expensesTotal)}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-red-400">-{formatNumber(totals.expensesTotal)}‚ÇΩ</td>
                                                </tr>
                                            </tbody>
                                            <tfoot className="bg-slate-900/50">
                                                <tr className="font-bold">
                                                    <td className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                    <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.totalIncome)}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-red-400">{formatNumber(totals.expensesTotal)}‚ÇΩ</td>
                                                    <td className="text-right py-2 px-2 text-blue-400 text-xl">{formatNumber(totals.netProfit)}‚ÇΩ</td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            )}

                            {/* –î–æ–ª–≥–æ–ª–µ—Ç–∏–µ */}
                            {activeTab === 'longevity' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üèÉ –ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –¥–æ–ª–≥–æ–ª–µ—Ç–∏–µ</h2>
                                        <button onClick={() => openModal('longevity')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                    {longevity.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-sm">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–î–∞—Ç–∞</th>
                                                        <th className="text-left py-2 px-2">–õ–æ–∫–∞—Ü–∏—è</th>
                                                        <th className="text-left py-2 px-2">–ü–µ–¥–∞–≥–æ–≥</th>
                                                        <th className="text-left py-2 px-2">–°—Ç–∞–≤–∫–∞</th>
                                                        <th className="text-right py-2 px-2">–õ—é–¥–µ–π</th>
                                                        <th className="text-right py-2 px-2">–î–æ—Ö–æ–¥</th>
                                                        <th className="text-right py-2 px-2">–†–∞—Å—Ö–æ–¥ –ø–µ–¥.</th>
                                                        <th className="text-right py-2 px-2">–†–∞—Å—Ö–æ–¥ –∑–∞–ª</th>
                                                        <th className="text-right py-2 px-2">–ü—Ä–∏–±—ã–ª—å</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {longevity.map((row, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{row.date}</td>
                                                            <td className="py-2 px-2">{row.location}</td>
                                                            <td className="py-2 px-2">{row.teacher}</td>
                                                            <td className="py-2 px-2">{row.rateType}</td>
                                                            <td className="text-right py-2 px-2">{row.people}</td>
                                                            <td className="text-right py-2 px-2 text-green-400">{formatNumber(row.income)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-red-400">{formatNumber(row.teacherExpense)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-red-400">{formatNumber(row.hallExpense)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-blue-400 font-bold">{formatNumber(row.profit)}‚ÇΩ</td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('longevity', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('longevity', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                                <tfoot className="bg-slate-900/50">
                                                    <tr className="font-bold">
                                                        <td colSpan="5" className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(longevity.reduce((s,i)=>s+i.income,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-red-400">{formatNumber(longevity.reduce((s,i)=>s+i.teacherExpense,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-red-400">{formatNumber(longevity.reduce((s,i)=>s+i.hallExpense,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-blue-400">{formatNumber(totals.longevityTotal)}‚ÇΩ</td>
                                                        <td></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª–∫–∏ */}
                            {activeTab === 'individual' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üë§ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏</h2>
                                        <button onClick={() => openModal('individual')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                    {individual.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–î–∞—Ç–∞</th>
                                                        <th className="text-left py-2 px-2">–¢–∏–ø</th>
                                                        <th className="text-left py-2 px-2">–ö–ª–∏–µ–Ω—Ç</th>
                                                        <th className="text-right py-2 px-2">–°—É–º–º–∞</th>
                                                        <th className="text-left py-2 px-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {individual.map((row, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{row.date}</td>
                                                            <td className="py-2 px-2">{row.type}</td>
                                                            <td className="py-2 px-2">{row.client}</td>
                                                            <td className="text-right py-2 px-2 text-green-400 font-semibold">{formatNumber(row.amount)}‚ÇΩ</td>
                                                            <td className="py-2 px-2 text-slate-400 text-sm">{row.comment}</td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('individual', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('individual', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                                <tfoot className="bg-slate-900/50">
                                                    <tr className="font-bold">
                                                        <td colSpan="3" className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.individualTotal)}‚ÇΩ</td>
                                                        <td colSpan="2"></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –ê—Ä–µ–Ω–¥–∞ */}
                            {activeTab === 'rental' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üè† –ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞</h2>
                                        <button onClick={() => openModal('rental')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                    {rental.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–î–∞—Ç–∞</th>
                                                        <th className="text-left py-2 px-2">–ò–º—è</th>
                                                        <th className="text-right py-2 px-2">–°—É–º–º–∞</th>
                                                        <th className="text-left py-2 px-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {rental.map((row, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{row.date}</td>
                                                            <td className="py-2 px-2">{row.name}</td>
                                                            <td className="text-right py-2 px-2 text-green-400 font-semibold">{formatNumber(row.amount)}‚ÇΩ</td>
                                                            <td className="py-2 px-2 text-slate-400 text-sm">{row.comment}</td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('rental', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('rental', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                                <tfoot className="bg-slate-900/50">
                                                    <tr className="font-bold">
                                                        <td colSpan="2" className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.rentalTotal)}‚ÇΩ</td>
                                                        <td colSpan="2"></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –†–∞—Å—Ö–æ–¥—ã */}
                            {activeTab === 'expenses' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üí∏ –†–∞—Å—Ö–æ–¥—ã</h2>
                                        <button onClick={() => openModal('expenses')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                    {expenses.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–î–∞—Ç–∞</th>
                                                        <th className="text-left py-2 px-2">–¢–∏–ø</th>
                                                        <th className="text-left py-2 px-2">–ß—Ç–æ</th>
                                                        <th className="text-right py-2 px-2">–°—É–º–º–∞</th>
                                                        <th className="text-left py-2 px-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {expenses.map((row, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{row.date}</td>
                                                            <td className="py-2 px-2">{row.type}</td>
                                                            <td className="py-2 px-2">{row.what}</td>
                                                            <td className="text-right py-2 px-2 text-red-400 font-semibold">{formatNumber(row.amount)}‚ÇΩ</td>
                                                            <td className="py-2 px-2 text-slate-400 text-sm">{row.comment}</td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('expenses', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('expenses', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                                <tfoot className="bg-slate-900/50">
                                                    <tr className="font-bold">
                                                        <td colSpan="3" className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                        <td className="text-right py-2 px-2 text-red-400">{formatNumber(totals.expensesTotal)}‚ÇΩ</td>
                                                        <td colSpan="2"></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –ü–∞—Å—Å–∏–≤–Ω—ã–π */}
                            {activeTab === 'passive' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üí∞ –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥</h2>
                                        <button onClick={() => openModal('passive')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                    {passive.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–î–∞—Ç–∞</th>
                                                        <th className="text-left py-2 px-2">–ß—Ç–æ</th>
                                                        <th className="text-right py-2 px-2">–°—É–º–º–∞/–º–µ—Å</th>
                                                        <th className="text-left py-2 px-2">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {passive.map((row, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{row.date}</td>
                                                            <td className="py-2 px-2">{row.what}</td>
                                                            <td className="text-right py-2 px-2 text-green-400 font-semibold">{formatNumber(row.amount)}‚ÇΩ</td>
                                                            <td className="py-2 px-2 text-slate-400 text-sm">{row.comment}</td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('passive', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('passive', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                                <tfoot className="bg-slate-900/50">
                                                    <tr className="font-bold">
                                                        <td colSpan="2" className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(totals.passiveTotal)}‚ÇΩ</td>
                                                        <td colSpan="2"></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –ë–∞–∑–∞ —É—á–µ–Ω–∏–∫–æ–≤ */}
                            {activeTab === 'students' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üë• –ë–∞–∑–∞ —É—á–µ–Ω–∏–∫–æ–≤</h2>
                                        <button onClick={() => openModal('students')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                        <div className="bg-slate-900/50 p-4 rounded-lg">
                                            <div className="text-slate-400 text-sm">–í—Å–µ–≥–æ —É—á–µ–Ω–∏–∫–æ–≤</div>
                                            <div className="text-2xl font-bold text-blue-400">{students.length}</div>
                                        </div>
                                        <div className="bg-slate-900/50 p-4 rounded-lg">
                                            <div className="text-slate-400 text-sm">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                                            <div className="text-2xl font-bold text-green-400">{students.filter(s=>s.status==='–ê–∫—Ç–∏–≤–Ω—ã–π').length}</div>
                                        </div>
                                        <div className="bg-slate-900/50 p-4 rounded-lg">
                                            <div className="text-slate-400 text-sm">–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥</div>
                                            <div className="text-2xl font-bold text-yellow-400">{formatNumber(students.length>0?totals.totalIncome/students.length:0)}‚ÇΩ</div>
                                        </div>
                                    </div>
                                    
                                    {students.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-sm">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–ò–º—è</th>
                                                        <th className="text-left py-2 px-2">–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                                        <th className="text-left py-2 px-2">–ì—Ä—É–ø–ø–∞</th>
                                                        <th className="text-left py-2 px-2">–ê–±–æ–Ω–µ–º–µ–Ω—Ç</th>
                                                        <th className="text-left py-2 px-2">–î–æ</th>
                                                        <th className="text-left py-2 px-2">–°—Ç–∞—Ç—É—Å</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {students.map((s, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{s.name}</td>
                                                            <td className="py-2 px-2">{s.phone}</td>
                                                            <td className="py-2 px-2">{s.group}</td>
                                                            <td className="py-2 px-2">{s.subscription}</td>
                                                            <td className="py-2 px-2">{s.expiryDate}</td>
                                                            <td className="py-2 px-2">
                                                                <span className={`px-2 py-1 rounded text-xs ${
                                                                    s.status==='–ê–∫—Ç–∏–≤–Ω—ã–π'?'bg-green-900/50 text-green-400':
                                                                    s.status==='–ü—Ä–æ–±–Ω—ã–π'?'bg-yellow-900/50 text-yellow-400':
                                                                    'bg-red-900/50 text-red-400'
                                                                }`}>{s.status}</span>
                                                            </td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('students', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('students', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ */}
                            {activeTab === 'analytics' && (
                                <div>
                                    <h2 className="text-xl font-bold mb-4">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ KPI</h2>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                        <div className="bg-slate-900/50 p-6 rounded-lg border border-slate-700">
                                            <h3 className="text-lg font-bold mb-4 text-green-400">üí∞ –§–∏–Ω–∞–Ω—Å—ã</h3>
                                            <div className="space-y-3">
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–¢–µ–∫—É—â–∏–π –¥–æ—Ö–æ–¥:</span>
                                                    <span className="font-semibold text-green-400">{formatNumber(totals.totalIncome)}‚ÇΩ</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å:</span>
                                                    <span className="font-semibold text-blue-400">{formatNumber(totals.netProfit)}‚ÇΩ</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å:</span>
                                                    <span className="font-semibold text-yellow-400">
                                                        {totals.totalIncome>0?Math.round((totals.netProfit/totals.totalIncome)*100):0}%
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="bg-slate-900/50 p-6 rounded-lg border border-slate-700">
                                            <h3 className="text-lg font-bold mb-4 text-blue-400">üë• –£—á–µ–Ω–∏–∫–∏</h3>
                                            <div className="space-y-3">
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–í—Å–µ–≥–æ —É—á–µ–Ω–∏–∫–æ–≤:</span>
                                                    <span className="font-semibold">{students.length}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–ê–∫—Ç–∏–≤–Ω—ã—Ö:</span>
                                                    <span className="font-semibold text-green-400">{students.filter(s=>s.status==='–ê–∫—Ç–∏–≤–Ω—ã–π').length}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥:</span>
                                                    <span className="font-semibold text-yellow-400">{formatNumber(students.length>0?totals.totalIncome/students.length:0)}‚ÇΩ</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="bg-slate-900/50 p-6 rounded-lg border border-slate-700">
                                            <h3 className="text-lg font-bold mb-4 text-purple-400">üéØ –¶–µ–ª–∏</h3>
                                            <div className="space-y-3">
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–¢–µ–∫—É—â–∏–π:</span>
                                                    <span className="font-semibold">{formatNumber(totals.netProfit)}‚ÇΩ</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–¶–µ–ª—å:</span>
                                                    <span className="font-semibold">1,000,000‚ÇΩ</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–û—Å—Ç–∞–ª–æ—Å—å:</span>
                                                    <span className="font-semibold text-red-400">{formatNumber(1000000-totals.netProfit)}‚ÇΩ</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-slate-300">–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                                                    <span className="font-semibold text-blue-400">{totals.progress}%</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="bg-slate-900/50 p-6 rounded-lg border border-slate-700">
                                            <h3 className="text-lg font-bold mb-4 text-orange-400">üìà –†–æ—Å—Ç</h3>
                                            <div className="space-y-3 text-sm text-slate-300">
                                                <div>–ß—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å 1–ú –Ω—É–∂–Ω–æ:</div>
                                                <div>‚Ä¢ –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥ –Ω–∞ {formatNumber(Math.round((1000000-totals.netProfit)/12))}‚ÇΩ/–º–µ—Å</div>
                                                <div>‚Ä¢ –ò–ª–∏ –ø—Ä–∏–≤–ª–µ—á—å ~{Math.round((1000000-totals.netProfit)/(students.length>0?totals.totalIncome/students.length:3000))} —É—á–µ–Ω–∏–∫–æ–≤</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-slate-900/50 p-6 rounded-lg border border-slate-700">
                                        <h3 className="text-lg font-bold mb-4 text-blue-400">üèÜ –¢–û–ü –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø–æ –ø—Ä–∏–±—ã–ª–∏</h3>
                                        <div className="space-y-3">
                                            {[
                                                {name:'–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ',value:totals.longevityTotal,color:'blue'},
                                                {name:'–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª–∫–∏',value:totals.individualTotal,color:'green'},
                                                {name:'–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞',value:totals.rentalTotal,color:'yellow'},
                                                {name:'–ü–∞—Å—Å–∏–≤–Ω—ã–π',value:totals.passiveTotal,color:'purple'}
                                            ].sort((a,b)=>b.value-a.value).map((item,idx)=>{
                                                const percent = totals.totalIncome>0?Math.round((item.value/totals.totalIncome)*100):0;
                                                return (
                                                    <div key={idx} className="flex items-center gap-3">
                                                        <div className="w-8 text-slate-400">{idx+1}.</div>
                                                        <div className="flex-1">
                                                            <div className="flex justify-between mb-1">
                                                                <span>{item.name}</span>
                                                                <span className={`font-bold text-${item.color}-400`}>{formatNumber(item.value)}‚ÇΩ ({percent}%)</span>
                                                            </div>
                                                            <div className="w-full bg-slate-700 rounded-full h-2">
                                                                <div className={`bg-${item.color}-500 h-2 rounded-full`} style={{width:`${percent}%`}}></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                        <div className="mt-4 p-3 bg-blue-900/30 rounded text-sm text-blue-300">
                                            üí° <strong>–§–æ–∫—É—Å:</strong> {
                                                totals.longevityTotal>=totals.individualTotal?'–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ - —Å–∞–º–æ–µ –ø—Ä–∏–±—ã–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ':'–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –¥–æ—Ö–æ–¥–∞'
                                            }
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* –ü–æ –º–µ—Å—è—Ü–∞–º */}
                            {activeTab === 'monthly' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üìÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –º–µ—Å—è—Ü–∞–º</h2>
                                        <button onClick={() => openModal('monthly')} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm">
                                            <Plus />–î–æ–±–∞–≤–∏—Ç—å –º–µ—Å—è—Ü
                                        </button>
                                    </div>
                                    {monthlyResults.length === 0 ? (
                                        <div className="text-center py-8 text-slate-400">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>
                                    ) : (
                                        <div className="overflow-x-auto">
                                            <table className="w-full text-sm">
                                                <thead>
                                                    <tr className="border-b border-slate-700">
                                                        <th className="text-left py-2 px-2">–ú–µ—Å—è—Ü</th>
                                                        <th className="text-right py-2 px-2">–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ</th>
                                                        <th className="text-right py-2 px-2">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª–∫–∏</th>
                                                        <th className="text-right py-2 px-2">–ê—Ä–µ–Ω–¥–∞</th>
                                                        <th className="text-right py-2 px-2">–ü–∞—Å—Å–∏–≤–Ω—ã–π</th>
                                                        <th className="text-right py-2 px-2">–†–∞—Å—Ö–æ–¥—ã</th>
                                                        <th className="text-right py-2 px-2">–ü—Ä–∏–±—ã–ª—å</th>
                                                        <th className="text-center py-2 px-2">–î–µ–π—Å—Ç–≤–∏—è</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {monthlyResults.map((row, idx) => (
                                                        <tr key={idx} className="border-b border-slate-700/50">
                                                            <td className="py-2 px-2">{row.month} {row.year}</td>
                                                            <td className="text-right py-2 px-2 text-green-400">{formatNumber(row.longevityIncome)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-green-400">{formatNumber(row.individualIncome)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-green-400">{formatNumber(row.rentalIncome)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-green-400">{formatNumber(row.passiveIncome)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-red-400">{formatNumber(row.expenses)}‚ÇΩ</td>
                                                            <td className="text-right py-2 px-2 text-blue-400 font-bold">{formatNumber(row.profit)}‚ÇΩ</td>
                                                            <td className="py-2 px-2">
                                                                <div className="flex gap-2 justify-center">
                                                                    <button onClick={() => openModal('monthly', idx)} className="text-blue-400"><Edit /></button>
                                                                    <button onClick={() => deleteItem('monthly', idx)} className="text-red-400"><Trash /></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                                <tfoot className="bg-slate-900/50">
                                                    <tr className="font-bold">
                                                        <td className="py-2 px-2">–ò–¢–û–ì–û:</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(monthlyResults.reduce((s,r)=>s+r.longevityIncome,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(monthlyResults.reduce((s,r)=>s+r.individualIncome,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(monthlyResults.reduce((s,r)=>s+r.rentalIncome,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-green-400">{formatNumber(monthlyResults.reduce((s,r)=>s+r.passiveIncome,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-red-400">{formatNumber(monthlyResults.reduce((s,r)=>s+r.expenses,0))}‚ÇΩ</td>
                                                        <td className="text-right py-2 px-2 text-blue-400">{formatNumber(monthlyResults.reduce((s,r)=>s+r.profit,0))}‚ÇΩ</td>
                                                        <td></td>
                                                    </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* –°–≤–æ–¥–∫–∞ */}
                            {activeTab === 'report' && (
                                <div>
                                    <div className="flex justify-between items-center mb-4">
                                        <h2 className="text-xl font-bold">üìà –°–≤–æ–¥–∫–∞</h2>
                                        <button onClick={exportToCSV} className="flex items-center gap-2 bg-green-600 hover:bg-green-700 px-3 py-2 rounded text-sm">
                                            <Download />–≠–∫—Å–ø–æ—Ä—Ç CSV
                                        </button>
                                    </div>
                                    <div className="space-y-3">
                                        <div className="flex justify-between p-3 bg-slate-900/50 rounded">
                                            <span>–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ (–ø—Ä–∏–±—ã–ª—å):</span>
                                            <span className="font-bold text-green-400">{formatNumber(totals.longevityTotal)}‚ÇΩ</span>
                                        </div>
                                        <div className="flex justify-between p-3 bg-slate-900/50 rounded">
                                            <span>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª–∫–∏:</span>
                                            <span className="font-bold text-green-400">{formatNumber(totals.individualTotal)}‚ÇΩ</span>
                                        </div>
                                        <div className="flex justify-between p-3 bg-slate-900/50 rounded">
                                            <span>–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞:</span>
                                            <span className="font-bold text-green-400">{formatNumber(totals.rentalTotal)}‚ÇΩ</span>
                                        </div>
                                        <div className="flex justify-between p-3 bg-slate-900/50 rounded">
                                            <span>–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥:</span>
                                            <span className="font-bold text-green-400">{formatNumber(totals.passiveTotal)}‚ÇΩ</span>
                                        </div>
                                        <div className="flex justify-between p-3 bg-slate-900/50 rounded">
                                            <span>–†–∞—Å—Ö–æ–¥—ã:</span>
                                            <span className="font-bold text-red-400">-{formatNumber(totals.expensesTotal)}‚ÇΩ</span>
                                        </div>
                                        <div className="flex justify-between p-4 bg-blue-900/50 rounded border-2 border-blue-600 mt-4">
                                            <span className="text-lg font-bold">–ß–ò–°–¢–ê–Ø –ü–†–ò–ë–´–õ–¨:</span>
                                            <span className="text-xl font-bold text-blue-400">{formatNumber(totals.netProfit)}‚ÇΩ</span>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */}
                    {showModal && (
                        <div className="fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 modal-backdrop" onClick={() => setShowModal(false)}>
                            <div className="bg-slate-800 rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto border border-slate-700 modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">{editingIndex !== null ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å'}</h3>
                                    <button onClick={() => setShowModal(false)} className="text-slate-400 hover:text-white">
                                        <X />
                                    </button>
                                </div>

                                <div className="space-y-3">
                                    {modalType === 'longevity' && (
                                        <>
                                            <input type="text" placeholder="–î–∞—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 06.12)" value={formData.date || ''} onChange={(e) => setFormData({...formData, date: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <select value={formData.location || ''} onChange={(e) => {
                                                const loc = e.target.value;
                                                setFormData({...formData, location: loc, hallExpense: getHallExpenseByLocation(loc)});
                                            }} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ª–æ–∫–∞—Ü–∏—é</option>
                                                <option value="–ë—É–¥–µ–Ω–Ω–æ–≥–æ">–ë—É–¥–µ–Ω–Ω–æ–≥–æ</option>
                                                <option value="–ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è">–ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è</option>
                                                <option value="–ü–∞—Ä–∫">–ü–∞—Ä–∫</option>
                                            </select>
                                            <input type="text" placeholder="–ò–º—è –ø–µ–¥–∞–≥–æ–≥–∞" value={formData.teacher || ''} onChange={(e) => setFormData({...formData, teacher: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <select value={formData.rateType || '50%'} onChange={(e) => setFormData({...formData, rateType: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="50%">–°—Ç–∞–≤–∫–∞: 50%</option>
                                                <option value="700‚ÇΩ">–°—Ç–∞–≤–∫–∞: 700‚ÇΩ</option>
                                                <option value="1000‚ÇΩ">–°—Ç–∞–≤–∫–∞: 1000‚ÇΩ</option>
                                                <option value="100%">–°—Ç–∞–≤–∫–∞: 100%</option>
                                            </select>
                                            <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ–ª–æ–≤–µ–∫" value={formData.people || ''} onChange={(e) => setFormData({...formData, people: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–†–∞—Å—Ö–æ–¥ –∑–∞ –∑–∞–ª (‚ÇΩ)" value={formData.hallExpense || 0} onChange={(e) => setFormData({...formData, hallExpense: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" value={formData.comment || ''} onChange={(e) => setFormData({...formData, comment: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    {modalType === 'individual' && (
                                        <>
                                            <input type="text" placeholder="–î–∞—Ç–∞" value={formData.date || ''} onChange={(e) => setFormData({...formData, date: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <select value={formData.type || ''} onChange={(e) => setFormData({...formData, type: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                                <option value="–ê–∑–±—É–∫–∞ —Ç–∞–Ω—Ü–∞">–ê–∑–±—É–∫–∞ —Ç–∞–Ω—Ü–∞</option>
                                                <option value="–õ–∞—Ç–∏–Ω—Å–∫–∏–π –∫–≤–∞—Ä—Ç–µ—Ç">–õ–∞—Ç–∏–Ω—Å–∫–∏–π –∫–≤–∞—Ä—Ç–µ—Ç</option>
                                                <option value="–ü—Ä–æ–∞–º">–ü—Ä–æ–∞–º</option>
                                                <option value="–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞">–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞</option>
                                                <option value="–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</option>
                                                <option value="–û—Å—Ç–∞–ª—å–Ω—ã–µ">–û—Å—Ç–∞–ª—å–Ω—ã–µ</option>
                                            </select>
                                            <input type="text" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞" value={formData.client || ''} onChange={(e) => setFormData({...formData, client: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–°—É–º–º–∞ (‚ÇΩ)" value={formData.amount || ''} onChange={(e) => setFormData({...formData, amount: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" value={formData.comment || ''} onChange={(e) => setFormData({...formData, comment: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    {modalType === 'rental' && (
                                        <>
                                            <input type="text" placeholder="–î–∞—Ç–∞" value={formData.date || ''} onChange={(e) => setFormData({...formData, date: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ò–º—è (–∫—Ç–æ –∞—Ä–µ–Ω–¥—É–µ—Ç)" value={formData.name || ''} onChange={(e) => setFormData({...formData, name: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–°—É–º–º–∞ (‚ÇΩ)" value={formData.amount || ''} onChange={(e) => setFormData({...formData, amount: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" value={formData.comment || ''} onChange={(e) => setFormData({...formData, comment: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    {modalType === 'expenses' && (
                                        <>
                                            <input type="text" placeholder="–î–∞—Ç–∞" value={formData.date || ''} onChange={(e) => setFormData({...formData, date: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <select value={formData.type || ''} onChange={(e) => setFormData({...formData, type: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                                <option value="–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞">–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞</option>
                                                <option value="–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã">–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</option>
                                                <option value="–£–≤–ª–µ—á–µ–Ω–∏—è">–£–≤–ª–µ—á–µ–Ω–∏—è</option>
                                            </select>
                                            <input type="text" placeholder="–£–∫–∞–∑–∞—Ç—å —á—Ç–æ" value={formData.what || ''} onChange={(e) => setFormData({...formData, what: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–°—É–º–º–∞ (‚ÇΩ)" value={formData.amount || ''} onChange={(e) => setFormData({...formData, amount: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" value={formData.comment || ''} onChange={(e) => setFormData({...formData, comment: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    {modalType === 'passive' && (
                                        <>
                                            <input type="text" placeholder="–î–∞—Ç–∞" value={formData.date || ''} onChange={(e) => setFormData({...formData, date: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–£–∫–∞–∑–∞—Ç—å —á—Ç–æ (–∏—Å—Ç–æ—á–Ω–∏–∫)" value={formData.what || ''} onChange={(e) => setFormData({...formData, what: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–°—É–º–º–∞ –≤ –º–µ—Å—è—Ü (‚ÇΩ)" value={formData.amount || ''} onChange={(e) => setFormData({...formData, amount: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" value={formData.comment || ''} onChange={(e) => setFormData({...formData, comment: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    {modalType === 'students' && (
                                        <>
                                            <input type="text" placeholder="–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è" value={formData.name || ''} onChange={(e) => setFormData({...formData, name: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="tel" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω (+7...)" value={formData.phone || ''} onChange={(e) => setFormData({...formData, phone: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <select value={formData.group || ''} onChange={(e) => setFormData({...formData, group: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>
                                                <option value="–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ –ë—É–¥–µ–Ω–Ω–æ–≥–æ">–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ –ë—É–¥–µ–Ω–Ω–æ–≥–æ</option>
                                                <option value="–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ –ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è">–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ –ß–µ—Ä–∫–∏–∑–æ–≤—Å–∫–∞—è</option>
                                                <option value="–õ–∞—Ç–∏–Ω—Å–∫–∏–π">–õ–∞—Ç–∏–Ω—Å–∫–∏–π</option>
                                                <option value="–ü—Ä–æ–∞–º">–ü—Ä–æ–∞–º</option>
                                                <option value="–í–Ω—É–∫–æ–≤–æ">–í–Ω—É–∫–æ–≤–æ</option>
                                            </select>
                                            <input type="text" placeholder="–ê–±–æ–Ω–µ–º–µ–Ω—Ç (8 –∑–∞–Ω—è—Ç–∏–π, –±–µ–∑–ª–∏–º–∏—Ç...)" value={formData.subscription || ''} onChange={(e) => setFormData({...formData, subscription: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="date" placeholder="–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ" value={formData.expiryDate || ''} onChange={(e) => setFormData({...formData, expiryDate: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <select value={formData.status || '–ê–∫—Ç–∏–≤–Ω—ã–π'} onChange={(e) => setFormData({...formData, status: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="–ê–∫—Ç–∏–≤–Ω—ã–π">–ê–∫—Ç–∏–≤–Ω—ã–π</option>
                                                <option value="–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π</option>
                                                <option value="–ü—Ä–æ–±–Ω—ã–π">–ü—Ä–æ–±–Ω—ã–π</option>
                                            </select>
                                            <input type="text" placeholder="–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ" value={formData.note || ''} onChange={(e) => setFormData({...formData, note: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    {modalType === 'monthly' && (
                                        <>
                                            <select value={formData.month || ''} onChange={(e) => setFormData({...formData, month: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white">
                                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü</option>
                                                {['–Ø–Ω–≤–∞—Ä—å','–§–µ–≤—Ä–∞–ª—å','–ú–∞—Ä—Ç','–ê–ø—Ä–µ–ª—å','–ú–∞–π','–ò—é–Ω—å','–ò—é–ª—å','–ê–≤–≥—É—Å—Ç','–°–µ–Ω—Ç—è–±—Ä—å','–û–∫—Ç—è–±—Ä—å','–ù–æ—è–±—Ä—å','–î–µ–∫–∞–±—Ä—å'].map(m => (
                                                    <option key={m} value={m}>{m}</option>
                                                ))}
                                            </select>
                                            <input type="number" placeholder="–ì–æ–¥ (2025)" value={formData.year || ''} onChange={(e) => setFormData({...formData, year: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–î–æ–ª–≥–æ–ª–µ—Ç–∏–µ (–ø—Ä–∏–±—ã–ª—å) ‚ÇΩ" value={formData.longevityIncome || ''} onChange={(e) => setFormData({...formData, longevityIncome: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ ‚ÇΩ" value={formData.individualIncome || ''} onChange={(e) => setFormData({...formData, individualIncome: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–∞ ‚ÇΩ" value={formData.rentalIncome || ''} onChange={(e) => setFormData({...formData, rentalIncome: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ ‚ÇΩ" value={formData.passiveIncome || ''} onChange={(e) => setFormData({...formData, passiveIncome: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="number" placeholder="–†–∞—Å—Ö–æ–¥—ã ‚ÇΩ" value={formData.expenses || ''} onChange={(e) => setFormData({...formData, expenses: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                            <input type="text" placeholder="–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ" value={formData.note || ''} onChange={(e) => setFormData({...formData, note: e.target.value})} className="w-full px-3 py-2 bg-slate-700 rounded border border-slate-600 text-white" />
                                        </>
                                    )}

                                    <div className="flex gap-2 mt-4">
                                        <button onClick={saveData} className="flex-1 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded font-semibold">
                                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                                        </button>
                                        <button onClick={() => setShowModal(false)} className="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded">
                                            –û—Ç–º–µ–Ω–∞
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<FinanceTracker />, document.getElementById('root'));
    </script>
</body>
</html>
